\section{Лекция 5 \\ Изоморфизм Карри-Ховарда (завершение), Унификация}
		\subsection{Изоморфизм Карри-Ховарда}
	\begin{definition}Изоморфизм Карри-Ховарда\end{definition}

	\begin{enumerate}
		\item $\Gamma$ $\vdash$ M:$\sigma$ влечет |$\Gamma$|$\vdash$ $\sigma$
		\item $\Gamma$ $\vdash$ $\sigma$, то существует M и существует $\Delta$, такое что |$\Delta$|=$\Gamma$, что $\Delta$ $\vdash$M:$\sigma$, где $\Delta$=\{$x_{\sigma}$:$\sigma$|$\sigma$ $\in$ $\Gamma$  \}
	\end{enumerate}
	\begin{example}\end{example}
	\{f:$\alpha\rightarrow\beta$, x:$\beta$\}$\vdash$fx:$\beta$ \\Применив изоморфизм Карри-Ховарда получим: \{$\alpha\rightarrow\beta$, $\beta$\}$\vdash\beta$
	\begin{proof}
	\end{proof}
	\par П.1 доказывается индукцией по длине выражения т.е. есть 3 правила вывода. убирая P и Q.
\par П.2 доказывается аналогичным способом но действия обратные.\\	
Т.е. отношения между типами в системе типов могут рассматриваться как образ отношений между высказываниями в логической системе, и наоборот.
\\
\\
\begin{definition}Расширенный полином определяется формулой:
\end{definition}
	\[
    E(p,q)= 
		\begin{cases}
    C,& \text{if }p=q=0\\
    p_1(p),& \text{if }q=0\\
    p_2(q),& \text{if }p=0\\
    p_3(p,q),& \text{if } p,q\neq0
		\end{cases}
	\]
	\[\text{, где }C-\text{константа, }\\p_1,p_2,p_3-\text{выражения, составленные из }*,+,p,q\text{ и констант}\]
	по сути расширенный полином это множество функций над натуральными числами(черчевскими нумералами).\par
	Пусть $\upsilon$ = $(\alpha\to\alpha)\to(\alpha\to\alpha)$, где $\alpha-$произвольный тип и пусть $F\in\Lambda\text{, что }F:\upsilon\to\upsilon\to\upsilon$, то существует расширенный полином $E$, такой что $\forall a,b\in \mathbb{N}$ $F(\overline{a},\overline{b})=_\beta \overline{E(a,b)}$, где $\overline{a}-$черчевский нумерал
	
	\begin{theorem}
	У каждого терма в просто типизиреумом $\lambda$ исчислении существует расширенный полином.
	\end{theorem}
		
	\begin{statement}Основные задачи типизации $\lambda$ исчисления\end{statement}
		\begin{enumerate}
			\item \emph{Проверка типа$-$}выполняется ли $\Gamma\vdash M:\sigma$ для контекста $\Gamma\text{ терма }M\text{ и типа }\sigma$ (для проверки типа обычно откидывают $\sigma$ и рассматривают п.2).
			\item \emph{Реконструкция типа$-$}можно ли подставить вместо $?$ и $?_1$ в $?_1\vdash M:?$ подставить конкретный тип $\sigma$ в $?$ и контекст $\Gamma$ в $?_1$.
			\item \emph{Обитаемость типа$-$}пытается подобрать, такой \textbf{замкнутый} терм $M$ и контекст $\Gamma$, что бы было выполнено $\Gamma\vdash M:\sigma$.
		\end{enumerate}			
	\begin{definition}Алгебраический терм\end{definition}Выражение типа $\Theta=a|(f_k \Theta_1\dotsb\Theta_n)$, \par где $a-$переменная, $(f_k \Theta_1\dotsb\Theta_n)-$применение функции\par
	\begin{example}\end{example}
	\begin{enumerate}
	\item $(f a b ( g a))$ 
	\item Известно, что $\to-$функция, тогда выражение $((a\to b)\to c)$ $\Longleftrightarrow$ $(\to (\to a b) c)$
\end{enumerate}		
	\subsection{Уравнение в алгебраических термах $\Theta_1=\Theta_2$\\Система уравнений в алгебраических термах}
	\begin{definition}Система уравнений в алгебраических термах\end{definition}
	$		
		\begin{cases}			
			\Theta_1=\sigma_1&\\
			\vdots&\\
			\Theta_n=\sigma_n&\\
		\end{cases}
	$\par где $\Theta_i \text{ и } \sigma_i-\text{термы}$\par
	\begin{definition}$\{a_i\}=A-$множество перменных, $\{\Theta_i\}=T-$множество термов.\end{definition}
	\begin{definition}Подстановка$-$отображение вида: $S_0:A\to T$, которое является решением в алгебраических термах.\end{definition} Т.е. $S_0-$конечное множество переменных $a_1\dotsb a_n$ на которых $S_0(a_i)=\Theta_i\text{ либо }S_0(a_i)=a_i$.\par
	Доопределим $S$ на все $T$ т.е. $S:T\to T$, где \begin{enumerate}
		\item $S(a)=S_0(a)$
		\item $S(f(\Theta_1 \dotsb \Theta_k))=f(S(\Theta_1) \dotsb S(\Theta_k))$
	\end{enumerate}
	По сути $S$ тоже самое что и много $if'$ов либо $map$ строк\par 
	\begin{definition}Решить уравнение в алгебраических термах$-$найти такое $S$, что $S(\Theta_1)=S(\Theta_2)$\end{definition} 
	\begin{example}\end{example}
		Заранее обозначим: $a,b-\text{переменные},$ $f,g,h-\text{функции}$
		\begin{enumerate}
			\item $f(a(gb))=f(he)d$ имеет решение $S(a)=he\text{ и }S(d)=gb$
				\begin{enumerate}
					\item $S(fa(gb))=f(he)(gb)$
					\item $S(f(he)d)=f(he)(gb)$
					\item $f(he)(gb)=f(he)(gb)$
				\end{enumerate}
			\item $fa=gb-$решений не имеет
		\end{enumerate}
		Таким образом, что бы существовало решение необходимо равенство строк полученной подстановки\par
		\subsection{Алгоритм Унификации}
		\begin{enumerate}
			\item Система уравнений $E_1$ эквивалентна $E_2$, если они имеют одинаковые решения(унификаторы).
			\item Любая система $E$ эквивалентна некторому уравнению $\Sigma_1=\Sigma_2$.
					
	\begin{proof}
	
	\end{proof}
		Возьмем функциональный символ $f$, не использующийся в $E$, \par
		$		
		E=\begin{cases}			
			\Theta_1=\sigma_1&\\
			\vdots&\\
			\Theta_n=\sigma_n&\\
		\end{cases}
		$\par
		это же уравнение можно записать как$-$ $f \Theta_1 \hdots \Theta_n=f\sigma_1 \hdots\sigma_n$\par 
		Если сущесвтует подстановка $S$ такая, что\par $S(\Theta_i)=S(\sigma_i)\:\forall i$, 
		то $S(f\:\Theta_1 \hdots \Theta_n)=f\:S(\sigma_1) \hdots S(\sigma_n)$\par Обратное аналогично.
		\item Рассмотрим операции
		\begin{enumerate}
			\item \textit{Редукция терма} \par 
					Заменим уравнение вида$-f_1\;\Theta_1 \hdots\Theta_n=f_1\;\sigma_1\hdots\sigma_n$ на систему уравнений\par$\Theta_1=\sigma_1$\par$\vdots$\par$\Theta_n=\sigma_n$
			\item \textit{Устранение переменной} \par
			Пусть есть уравнеие $x=\Theta$, заменим во всех остальных уравнениях переменную $x$ на терм $\Theta$		
		\end{enumerate}
		\begin{statement} Эти операции не изменяют множества решений.\end{statement}
	\end{enumerate}	
		\begin{definition}Система уравнений в разрешеной форме если \end{definition}
			\begin{enumerate}
				\item Все уравнения имеют вид $a_i=\Theta_i$
				\item Каждый из $a_i$ входит в систему уравнений только раз
			\end{enumerate}
		\begin{definition}Система несовместима если\end{definition} 
		\begin{enumerate}
			\item существует уравнение вида $f\:\Theta_1\hdots\Theta_n=g\:\sigma_1\hdots\sigma_n$, где $f\neq g$
			\item существует уравнение вида $a=f\: \Theta_1\hdots\Theta_n\:$, причем $a$ выходит в какой-то из $\Theta_i$
		\end{enumerate}			
		\subsection{ Алгоритм унификации}
		\begin{enumerate}
		\item Пройдемся по системе, выберем такое уравнение, что оно удовлетворяет одному из условий:\begin{enumerate}
			\item Если $\Theta_i=a_i$, то перепишем, как $a_i=\Theta_i$, $\Theta_i-$не переменная
			\item $a_i=a_i-$ удалим
			\item $f\:\Theta_1\hdots\Theta_n=f\:\sigma_1\hdots\sigma_n$  применим редукцию термов 
			\item $a_i=\Theta_i$ Применим подстановку переменной т.е. подставим во все остальне уравнения $\Theta_i$ вместо $a_i$
		\end{enumerate}
		\item Проверим разрешима ли система, совместима ли система (два пункта несовместимости)
		\item повторим пункт 1 		
		\end{enumerate}
		
		\begin{statement} Алгоритм не изменяет множетва решений\end{statement}
		\begin{statement} Несовместимая решения не имеет решений\end{statement}
		\begin{statement} Система в разрешеной форме имеет решение:\end{statement}	
		
	\begin{align*}
		\begin{cases}			
			a_1=\Theta_1&\\
			\vdots&\\
			a_n=\Theta_n&\\
		\end{cases} & \text{имеет решение}-&\begin{cases}			
			S_0(a_1)=\Theta_1&\\
			\vdots&\\
			S_0(a_n)=\Theta_n&\\
		\end{cases}\\
	\end{align*}
	\begin{statement}Алгоритм всегда закначивается\end{statement}
	\begin{proof}\end{proof} По индукции, выберем три числа $ \big \langle x\:y\:z\big \rangle$, где\par $x-$количество переменных, которые встречаются строго больше одного раза в левой части некоторого уравнения (т.е. $b$ не повлияет на $x$, а $a$ повлияет в уравнении $f(a(g\:a)\:b)=\Theta$),\par $y-$ количество функциональных символов в системе,\par $z-$количество уравнеий типа $a=a$ и $\Theta=b$ \par
		\textit{Заметим}, что $(a)$ и $(b)$ всегда уменьшают $z$ и иногда уменьшают $x$,\par $(c)$ всегда уменьшает $y$ иногда $x$ и, возможно, увеличивает $z$,\par операция $(d)$ всегда уменьшает $x$, и иногда увеличивает $y$.\par
		Очевидно, что с каждой операцией $a-d$ данная тройка уменьшается и так как $x,y,z\geq 0$, то данный алгоритм завершится за конечное время.
		\begin{example}\end{example}
			\begin{flalign*}
				\text{Исходная система}\\
				E=&&\\
				g(x_2)=x_1\\
				f(x_1, h(x_1),x_2)=f(g(x_3),x_4,x_3)
			\end{flalign*}
			
			\begin{flalign*}
				\text{Применим пункт $(c)$ ко второму уравнению верхней системы получим:}\\
				E=&&\\
				g(x_2)=x_1\\
				x_1=g(x_3)\\
				h(x_1)=x_4\\
				x_2=x_3
			\end{flalign*}
			
			\begin{flalign*}
				\text{Применим пункт $(d)$ ко второму уравнению верхней системы}\\ 
				\text{(оно изменит 1ое уравнение) получим:}\\
				E=&&\\
				g(x_2)=g(x_3)\\
				x_1=g(x_3)\\
				h(g(x_3))=x_4\\
				x_2=x_3
			\end{flalign*}
			
			\begin{flalign*}
				\text{Применим пункт $(c)$ ко первому ур-ию}\\
				\text{и пункт $(a)$ к третьему уравнению верхней системы}\\
				E=&&\\
				x_2=x_3\\
				x_1=g(x_3)\\
				x_4=h(g(x_3))\\
				x_2=x_3
			\end{flalign*}
			
			\begin{flalign*}
			\text{Применим пункт $(b)$ к последнему уравнению и}\\
			\text{получим систему в разрешеной форме}\\
				E=&&\\
				x_2=x_3\\
				x_1=g(x_3)\\
				x_4=h(g(x_3))
			\end{flalign*}
			
			Решение системы: \begin{align*}
						 S=\{\\
			(x_1=g(x_3)),\\
			(x_2=x_3),\\
			(x_4=h(g(x_3))))\\
			\}
			\end{align*}			
			
	\begin{definition} $S \circ T-$композиция подстановок, если $S \circ T=S(T(a))$\end{definition}
	\begin{definition} $S-$наиболее общий унификатор ксли любое решение сисетмы $R$ может быть получено уточнением: $\exists T:R=T\circ S$\end{definition}
	\begin{statement} Алгоритм дает наиболее общий унификатор системы, если у нее есть решения. Если решений нет алгоритм окончится неудачей.\end{statement}
